"use strict";angular.module("easyToDoApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngTouch","ngStorage"]).config(["$routeProvider","$httpProvider","$localStorageProvider",function(a,b){a.when("/",{title:"easyToDo",templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/Login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/Login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/category",{templateUrl:"views/category.html",controller:"CategoryCtrl"}).when("/list",{templateUrl:"views/list.html",controller:"ListCtrl"}).otherwise({redirectTo:"/"}),b.defaults.useXDomain=!0,delete b.defaults.headers.common["X-Requested-With"]}]).run(["$location","$rootScope",function(a,b){b.$on("$routeChangeSuccess",function(a,c){b.title=c.$$route.title})}]),angular.module("easyToDoApp").controller("LoginCtrl",["$scope","$location","dataPool",function(a,b,c){a.login=function(){console.log(a.username),c.setUserName(a.username),b.path("/category")}}]),angular.module("easyToDoApp").controller("CategoryCtrl",["$scope","dataPool","$location",function(a,b,c){function d(){a.categroyList=b.getCategoryList()}function e(){0===b.getUserName().length&&c.path("/"),d()}function f(){b.addCategory(a.sthToAdd),a.sthToAdd="",d()}function g(){c.path("/")}function h(a){b.setCurCategoryIndex(a),c.path("/list")}function i(a,c){c.stopPropagation(),console.log(a),confirm("are u sure?")&&(b.deleteCategory(a),d())}a.user=b.getUserName(),a.doAdd=f,a.showToDoList=h,a.goback=g,a.deleteCategory=i,e()}]),angular.module("easyToDoApp").service("dataPool",["$localStorage",function(a){function b(a){this.username=a,this.categroyList=[],this.toDoList=[]}function c(){var b="easyToDo"+e.username;a[b]=e}function d(){var b="easyToDo"+e.username;a[b]&&(e=a[b])}var e,f;b.prototype.getToDoListLength=function(){return this.toDoList.length};var g=function(a,b){this.action=a,this.id=b,this.status=1,this.index=e.toDoList.length},h=function(a){this.subject=a,this.display=!0};return{setUserName:function(a){e=new b(a),d(a)},getUserName:function(){return e?e.username:""},addCategory:function(a){var b=new h(a);e.categroyList.push(b),c()},getCategoryList:function(){return e?e.categroyList:[]},setCurCategoryIndex:function(a){f=a,c()},getCurCategoryIndex:function(){return f},getCurCategoryName:function(){return e?e.categroyList[f].subject:""},addTodoItem:function(a){var b=new g(a,f);e.toDoList.push(b),c()},getTodoListByCategory:function(){var a=[];if(e)for(var b=0;b<e.toDoList.length;b++)e.toDoList[b].id===f&&a.push(e.toDoList[b]);return a},getTodoListForAll:function(){return e.toDoList},deleteCategory:function(a){e.categroyList[a].display=!1,c()},setTodoItemStatus:function(a,b){e.toDoList[a].status=b,c()}}}]),angular.module("easyToDoApp").directive("easyAdd",function(){return{templateUrl:"views/easyadd.html",restrict:"E",link:function(){}}}),angular.module("easyToDoApp").controller("ListCtrl",["$scope","$location","dataPool",function(a,b,c){function d(){a.toDoList=c.getTodoListByCategory()}function e(){c.addTodoItem(a.sthToAdd),d(),a.sthToAdd=""}function f(b,d){var e=a.toDoList[b].index,f=0==a.toDoList[b].status?1:0;d.stopPropagation(),c.setTodoItemStatus(e,f)}function g(b,e){var f=a.toDoList[b].index,g=-1;e.stopPropagation(),c.setTodoItemStatus(f,g),d()}function h(){b.path("/category")}0===c.getCurCategoryName().length&&b.path("/"),a.curCategory=c.getCurCategoryName(),a.doAdd=e,a.goback=h,a.toggleStatus=f,a.deleteItem=g,d()}]),angular.module("easyToDoApp").directive("goback",function(){return{template:'<button class="btn btn-default" ng-click="goback()">back</button>',restrict:"E",link:function(){}}});